project: "Cult of Joey Infra Deployment"
version: "2025-11-08"

environments:
  - name: vps.host
    domain: freqkflag.co
    services:
      - traefik
      - infisical
      - kong
      - gitea
      - ghost
      - wordpress
      - discourse
      - wikijs
      - linkstack
      - localai
      - openwebui
      - node-red
      - clamav
      - postgres
      - mariadb
      - redis
  - name: home.macmini
    domain: twist3dkink.online
    services:
      - frontend
      - dev-tools
  - name: home.linux
    domain: cult-of-joey.com
    services:
      - vaultwarden
      - bookstack
      - auxiliary

workflows:
  deploy:
    - preflight-check
    - load-secrets
    - compose-up
    - verify-health
    - log-changelog
  backup:
    - backup-databases
    - sync-to-homelab
  security:
    - scan-malware
    - rotate-keys
    - firewall-audit

policies:
  secrets: infisical-only
  databases: centralized-on-vps
  ingress: cloudflare-tunnels
  network: edge-shared
